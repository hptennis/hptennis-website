<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Grid</title>
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
 

</head>
<body>

    <h1>My Grid</h1>
    <div id="jsGrid"></div>
    <div id="jsGrid2"></div>
    

    <script src="js/lib/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>

    <script>
        var clients = [
            { "Name": "Otto Clay", "Age": 25, "Country": 1, "Address": "Ap #897-1459 Quam Avenue", "Married": false },
            { "Name": "Connor Johnston", "Age": 45, "Country": 2, "Address": "Ap #370-4647 Dis Av.", "Married": true },
            { "Name": "Lacey Hess", "Age": 29, "Country": 3, "Address": "Ap #365-8835 Integer St.", "Married": false },
            { "Name": "Timothy Henson", "Age": 56, "Country": 1, "Address": "911-5143 Luctus Ave", "Married": true },
            { "Name": "Ramona Benton", "Age": 32, "Country": 3, "Address": "Ap #614-689 Vehicula Street", "Married": false }
        ];
     
        var countries = [
            { Name: "", Id: 0 },
            { Name: "United States", Id: 1 },
            { Name: "Canada", Id: 2 },
            { Name: "United Kingdom", Id: 3 }
        ];
     
        $("#jsGrid2").jsGrid({
            width: "100%",
            height: "400px",
     
            inserting: true,
            editing: true,
            sorting: true,
            paging: true,
     
            data: clients,
     
            fields: [
                { name: "Name", type: "text", width: 150, validate: "required" },
                { name: "Age", type: "number", width: 50 },
                { name: "Address", type: "text", width: 200 },
                { name: "Country", type: "select", items: countries, valueField: "Id", textField: "Name" },
                { name: "Married", type: "checkbox", title: "Is Married", sorting: false },
                { type: "control" }
            ]
        });
        $(function() {

            var sheet_url = "https://script.google.com/macros/s/AKfycby6wkVv9xbATIt8JVeZR71nYxnaKy3n60UJznWo5PYdPaTH2lmT/exec";  
                             
            var json_url = "https://script.googleusercontent.com/a/macros/hampdenparktennis.co.uk/echo?user_content_key=NyJ-xLERp5syHkQab-cD2BRZq_RpQvKLwPKvmlL3aPTmwMVs2j2Qmblxp1GXWHbZWATltTAd4olAsU9_z5N2QCL6P3dm-0TJOJmA1Yb3SEsKFZqtv3DaNYcMrmhZHmUMi80zadyHLKBNMQVoIY4u_HA_9DDdC3ckIgTKRbUcUWo1jL5rQSxcTigCYJ2iqUZiSPo39O4SX4Oidipr-HchWhxMycpYRm7bAO4ohdG-jPC_GoyoV3JYNgydwXvHOb5ik2J4XWNE-9bZQdMdYte0gq12BgTJOh8yesQjXkDBtZi_Ri_rd4DIlcWgYh8rvR6Cuw4XfZpQqeU&lib=MbpKbbfePtAVndrs259dhPT7ROjQYJ8yx";
            
 
 $("#jsGrid").jsGrid({
     height: "auto",
     width: "100%",

     filtering: true,
     inserting: true,
     editing: true,
     sorting: true,
     paging: false,
     autoload: true,
    

     controller: {
         loadData: function() {
             var d = $.Deferred();

             $.ajax({
                 url:sheet_url,
                 dataType: "json"
             }).done(function(response) {
                
                debugger; 
                var jdata = JSON.stringify(response.Sheet1);
                var sdata = response;
                 console.log("respone:"+sdata);
                   
                 d.resolve(sdata);
                 //d.resolve(jQuery.parseJSON(response));
             });

             return d.promise();
         }
     },

     fields: [
         { name: "Timestamp",  type: "text", width: 30 },
         { name: "firstname", title: "First Name", type: "text", width: 10 },
         { name: "surname", title: "Surname", type: "text", width: 10 },
         { name: "email", type: "text", width: 30 },
         { name: "phone", type: "text", width: 15 },
         { name: "address1",title: "Address 1", type: "text", width: 20 },
         { name: "address2",title: "Address 2", type: "text", width: 15 },
         { name: "postcode",title: "Post Code", type: "text", width: 5 },
         { name: "membership_type",title: "Membership", type: "text", width: 5 },  
         { name: "2018",title: "2018", type: "text", width: 5 },  
         { type: "control", width: 2 }
         
        //  { name: "Rating", type: "number", width: 50, align: "center",
        //      itemTemplate: function(value) {
        //          return $("<div>").addClass("rating").append(Array(value + 1).join("&#9733;"));
        //      }
        //  },
        //  { name: "Price", type: "number", width: 50,
        //      itemTemplate: function(value) {
        //          return value.toFixed(2) + "$"; }
        //  }
     ]
 });


 

});


    </script>
</body>
</html>